# Инструкции по созданию и восстановлению дампа базы данных

В этом документе приведены инструкции по созданию полного дампа базы данных и его восстановлению.

## Создание дампа базы данных

Для создания полного дампа базы данных выполните следующую команду:

```bash
pg_dump "$DATABASE_URL" > database_dump.sql
```

Результатом будет файл `database_dump.sql`, содержащий полный дамп вашей базы данных, включая:
- Структуру всех таблиц
- Данные таблиц
- Индексы и ограничения
- Триггеры и функции
- Последовательности

## Восстановление базы данных из дампа

Для полного восстановления базы данных из дампа используйте следующую команду:

```bash
psql "$DATABASE_URL" < database_dump.sql
```

Эта команда удалит все существующие объекты в базе данных и восстановит их из дампа.

## Создание дампа только структуры (без данных)

Если вам нужен дамп только структуры базы данных без данных, используйте следующую команду:

```bash
pg_dump --schema-only "$DATABASE_URL" > database_schema.sql
```

## Создание дампа только данных

Для создания дампа только данных без структуры таблиц:

```bash
pg_dump --data-only "$DATABASE_URL" > database_data.sql
```

## Восстановление только данных

Для восстановления только данных (предполагая, что структура таблиц уже существует):

```bash
psql "$DATABASE_URL" < database_data.sql
```

## Дамп отдельных таблиц

Для создания дампа только определенных таблиц:

```bash
pg_dump -t departments -t positions "$DATABASE_URL" > selected_tables.sql
```

## Важные замечания

1. **Переменная окружения**: Убедитесь, что переменная окружения `DATABASE_URL` содержит корректную строку подключения к базе данных.

2. **Права доступа**: Пользователь, выполняющий команды, должен иметь достаточные права доступа к базе данных.

3. **Версии PostgreSQL**: При восстановлении дампа версия PostgreSQL должна быть совместима с версией, на которой был создан дамп.

4. **Размер файла**: Для больших баз данных размер дампа может быть значительным. Убедитесь, что у вас достаточно места на диске.

5. **Типы дампа**: 
   - **Полный дамп** (`pg_dump без параметров`) - включает данные и схему
   - **Схема** (`pg_dump --schema-only`) - только структура без данных
   - **Данные** (`pg_dump --data-only`) - только данные без структуры