-- Тестовые данные для новой иерархической структуры

-- Удаляем данные из связанных таблиц (каскадное удаление)
TRUNCATE employees, position_department CASCADE;
TRUNCATE departments CASCADE;
TRUNCATE positions CASCADE;

-- Создаем должности (позиции) с иерархией
INSERT INTO positions (position_id, name, parent_position_id, staff_units, vacancies) VALUES
(1, 'Директор', NULL, 1, 0),                       -- Верхний уровень (уровень 1)
(2, 'Руководитель отдела разработки', 1, 1, 0),   -- Уровень 2
(3, 'Руководитель отдела маркетинга', 1, 1, 0),   -- Уровень 2
(4, 'Руководитель отдела продаж', 1, 1, 0),       -- Уровень 2
(5, 'Старший разработчик', 2, 2, 1),              -- Уровень 3
(6, 'Младший разработчик', 5, 3, 2),               -- Уровень 4
(7, 'Маркетолог', 3, 2, 1),                        -- Уровень 3
(8, 'Менеджер по продажам', 4, 3, 1);              -- Уровень 3

-- Проставляем количество занятых единиц (для примера)
UPDATE positions SET current_count = 1 WHERE position_id IN (1, 2, 3, 4, 5, 7, 8);
UPDATE positions SET current_count = 1 WHERE position_id = 6;

-- Создаем отделы с привязкой к должностям менеджеров (parent_position_id)
INSERT INTO departments (department_id, name, parent_position_id) VALUES
(1, 'Администрация', NULL),                         -- Без родительской должности
(2, 'Отдел разработки', 1),                         -- Родитель - Директор (position_id = 1)
(3, 'Отдел маркетинга', 1),                         -- Родитель - Директор (position_id = 1)
(4, 'Отдел продаж', 1),                             -- Родитель - Директор (position_id = 1)
(5, 'Команда фронтенда', 2),                        -- Родитель - Руководитель отдела разработки (position_id = 2)
(6, 'Команда бэкенда', 2);                          -- Родитель - Руководитель отдела разработки (position_id = 2)

-- Связываем должности с отделами
INSERT INTO position_department (position_id, department_id, sort) VALUES
(1, 1, 1),    -- Директор работает в Администрации
(2, 2, 1),    -- Руководитель отдела разработки работает в Отделе разработки
(3, 3, 1),    -- Руководитель отдела маркетинга работает в Отделе маркетинга
(4, 4, 1),    -- Руководитель отдела продаж работает в Отделе продаж
(5, 5, 1),    -- Старший разработчик работает в Команде фронтенда
(6, 5, 2),    -- Младший разработчик работает в Команде фронтенда
(6, 6, 1),    -- Младший разработчик также работает в Команде бэкенда
(7, 3, 2),    -- Маркетолог работает в Отделе маркетинга
(8, 4, 2);    -- Менеджер по продажам работает в Отделе продаж

-- Создаем сотрудников и назначаем их на должности
INSERT INTO employees (employee_id, full_name, position_id, email, phone, manager_id, department_id) VALUES
(1, 'Иванов Иван Иванович', 1, 'ivanov@example.com', '+7 (999) 123-45-67', NULL, 1),   -- Директор
(2, 'Петров Петр Петрович', 2, 'petrov@example.com', '+7 (999) 234-56-78', 1, 2),     -- Руководитель отдела разработки
(3, 'Сидорова Елена Владимировна', 3, 'sidorova@example.com', '+7 (999) 345-67-89', 1, 3), -- Руководитель отдела маркетинга
(4, 'Козлов Алексей Сергеевич', 4, 'kozlov@example.com', '+7 (999) 456-78-90', 1, 4),  -- Руководитель отдела продаж
(5, 'Смирнов Дмитрий Александрович', 5, 'smirnov@example.com', '+7 (999) 567-89-01', 2, 2), -- Старший разработчик
(6, 'Новикова Анна Михайловна', 6, 'novikova@example.com', '+7 (999) 678-90-12', 5, 2), -- Младший разработчик
(7, 'Морозова Ольга Игоревна', 7, 'morozova@example.com', '+7 (999) 789-01-23', 3, 3), -- Маркетолог
(8, 'Кузнецов Николай Евгеньевич', 8, 'kuznetsov@example.com', '+7 (999) 890-12-34', 4, 4); -- Менеджер по продажам